import{x as u,k as b,w as ue,o as de,e as pe,a8 as p,a9 as g,aa as s,l as v,ab as i,ac as f,ad as r,ae as ve,af as x,F as V,ag as fe,E as P,ah as me,ai as C,aj as M,ak as he}from"./vendor-182afd1e.js";import{A as _e,_ as ye,B as ge,C as be,a as xe,S as we,b as ke,c as Te}from"./vendor-antd-b5619c7b.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))h(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const _ of l.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&h(_)}).observe(document,{childList:!0,subtree:!0});function m(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function h(a){if(a.ep)return;a.ep=!0;const l=m(a);fetch(a.href,l)}})();const Se={id:"app-container"},Ce={class:"sidebar"},Le={class:"brand"},Oe={style:{display:"flex",gap:"8px"}},ze={key:0},Ee={key:1},Pe={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"12px"}},Me={style:{"margin-top":"8px",display:"flex","justify-content":"space-between","font-size":"12px",color:"var(--text-secondary)"}},He={style:{"margin-top":"4px","font-size":"12px",color:"var(--text-secondary)"}},Ie={class:"main"},qe={class:"navbar"},je={style:{"font-weight":"600","font-size":"13px"}},Be=["title"],Ne={class:"col-path"},Ae=["title"],De={key:0,class:"query-string"},Re={key:1,style:{color:"var(--text-secondary)",opacity:"0.7","font-style":"italic"}},Ue={class:"col-meta"},L=36,H=2e3,Ve={__name:"App",setup($){const c=u([]),m=u([]),h=u([]),a=u(""),l=u(!1),_=u(!1),O=u({pv:0,uv:0}),d=u(null),F=u("access.log"),y=u(localStorage.getItem("theme")!=="light"),I=u(0),q=u(800),Y=b(()=>Math.ceil(q.value/L)+5),z=b(()=>Math.floor(I.value/L)),G=b(()=>j.value.slice(z.value,z.value+Y.value)),K=b(()=>j.value.length*L),Q=b(()=>z.value*L),W=t=>{I.value=t.target.scrollTop},w=()=>{d.value&&(q.value=d.value.clientHeight)};let k=null;const J=()=>{if(h.value.length===0)return;const t=[...c.value,...h.value];h.value=[],t.length>H?c.value=t.slice(t.length-H):c.value=t,P(()=>{if(d.value){const e=d.value;e.scrollHeight-e.scrollTop-e.clientHeight<200&&(e.scrollTop=e.scrollHeight)}})},X=t=>{t.timeOnly=N(t.time);const e=Object.freeze(t);if(l.value){m.value.push(e);return}h.value.push(e),k||(k=setInterval(J,100))},j=b(()=>{const t=c.value;if(!a.value)return t;const e=a.value.toLowerCase();return t.filter(n=>n.path&&n.path.toLowerCase().includes(e)||n.ip&&n.ip.includes(e)||n.status&&String(n.status).includes(e))}),Z=b(()=>y.value?"#cccccc":"#333333"),ee=()=>{y.value=!y.value,localStorage.setItem("theme",y.value?"dark":"light")};ue(y,t=>{document.documentElement.setAttribute("data-theme",t?"dark":"light")},{immediate:!0});const te=t=>{const e={GET:"#4ec9b0",POST:"#569cd6",PUT:"#dcdcaa",DELETE:"#f44747"};return y.value?e[t]||"#cccccc":{GET:"#059669",POST:"#2563eb",PUT:"#d97706",DELETE:"#dc2626"}[t]||"#666"},se=t=>t<300?"c-2xx":t<400?"c-3xx":t<500?"c-4xx":"c-5xx",oe=t=>t?t.split("?")[0]:"",B=t=>{let e="";if(t.query&&t.query!=="-"?(e=t.query,e.startsWith("?")&&(e=e.substring(1))):t.path&&t.path.includes("?")&&(e=t.path.split("?")[1]),!e)return"";try{return decodeURIComponent(e)}catch{return e}},N=t=>{if(!t)return"--:--:--";const e=t.split(":");return e.length>=4?e.slice(1,4).join(":").split(" ")[0]:t};let T=null;const A=()=>{const t=window.location.protocol==="https:"?"wss":"ws",e=window.location.host;T=new WebSocket(`${t}://${e}/ws`),T.onopen=()=>_.value=!0,T.onclose=()=>{_.value=!1,setTimeout(A,2e3)},T.onmessage=n=>{try{X(JSON.parse(n.data))}catch{}}},ae=async()=>{try{O.value=await(await fetch("/api/stats")).json()}catch{}},D=async()=>{try{const e=await(await fetch("/api/history")).json();e&&(c.value=e.reverse().map(n=>({...n,timeOnly:N(n.time),id:n.id||Math.random()})).map(Object.freeze),P(()=>{w(),d.value&&(d.value.scrollTop=d.value.scrollHeight)}))}catch{}},le=()=>{l.value=!l.value,l.value||(m.value.length>0&&(c.value=[...c.value,...m.value].slice(-H),m.value=[]),P(()=>{d.value&&(d.value.scrollTop=d.value.scrollHeight)}))},ne=()=>{c.value=[],m.value=[],h.value=[]};return de(()=>{A(),D(),setInterval(ae,5e3),w(),window.addEventListener("resize",w)}),pe(()=>{k&&clearInterval(k),window.removeEventListener("resize",w)}),(t,e)=>{const n=_e,R=ye,S=ge,ie=we,re=be,E=xe,ce=ke,U=Te;return p(),g("div",Se,[s("aside",Ce,[s("div",Le,[v(n,{size:"small",style:{"background-color":"var(--accent-color)"}},{icon:i(()=>[...e[2]||(e[2]=[f("âš¡ï¸",-1)])]),_:1}),e[3]||(e[3]=f(" Sonic Stellar ",-1))]),v(R,{value:a.value,"onUpdate:value":e[0]||(e[0]=o=>a.value=o),placeholder:"Filter (Cmd+K)","allow-clear":"",style:{"margin-bottom":"8px"}},null,8,["value"]),s("div",Oe,[v(S,{type:"primary",danger:l.value,onClick:le,block:"",ghost:""},{icon:i(()=>[l.value?(p(),g("span",Ee,"â–¶ï¸")):(p(),g("span",ze,"â¸"))]),default:i(()=>[f(" "+r(l.value?m.value.length>0?`Resume (${m.value.length})`:"Resume":"Pause"),1)]),_:1},8,["danger"]),v(S,{onClick:ne,block:""},{default:i(()=>[...e[4]||(e[4]=[f(" ðŸ—‘ Clear ",-1)])]),_:1})]),v(re,{size:"small",bordered:!1,style:{background:"var(--card-bg)","margin-top":"auto"}},{default:i(()=>[s("div",Pe,[e[5]||(e[5]=s("span",{style:{"font-size":"12px","font-weight":"600",color:"var(--text-secondary)"}},"STATISTICS",-1)),v(S,{type:"text",size:"small",onClick:ee},{default:i(()=>[f(r(y.value?"ðŸŒ™":"â˜€ï¸"),1)]),_:1})]),v(ie,{title:"Total Requests",value:O.value.pv,"value-style":{color:Z.value}},null,8,["value","value-style"]),s("div",Me,[e[6]||(e[6]=s("span",null,"Unique Visitors",-1)),s("span",null,r(O.value.uv),1)]),s("div",He,[e[7]||(e[7]=f(" Status: ",-1)),s("span",{style:x({color:_.value?"#4ec9b0":"#f44747"})},r(_.value?"Live":"Offline"),5)]),v(S,{size:"small",type:"link",onClick:D,style:{padding:"0","margin-top":"8px"}},{default:i(()=>[...e[8]||(e[8]=[f("Load History",-1)])]),_:1})]),_:1})]),s("main",Ie,[s("div",qe,[s("span",je,r(F.value),1),v(E,{color:"#2db7f5"},{default:i(()=>[f(r(c.value.length)+" Events",1)]),_:1})]),e[11]||(e[11]=ve('<div class="log-row header-row"><div class="col-time">Time</div><div class="col-status">Status</div><div class="col-method">Method</div><div class="col-path">Path / Query</div><div class="col-meta">Client</div></div>',1)),s("div",{class:"log-list",ref_key:"listRef",ref:d,onScroll:W},[s("div",{style:x({height:`${K.value}px`,position:"relative"})},[s("div",{style:x({transform:`translateY(${Q.value}px)`})},[(p(!0),g(V,null,fe(G.value,o=>(p(),g("div",{key:o.id||Math.random(),class:"log-row"},[s("div",{class:"col-time",title:o.time},r(o.timeOnly),9,Be),s("div",{class:me(["col-status status-badge",se(o.status)])},r(o.status),3),s("div",{class:"col-method",style:x({color:te(o.method)})},r(o.method),5),s("div",Ne,[o.path?(p(),g(V,{key:0},[s("span",{title:o.path},r(oe(o.path)),9,Ae),B(o)?(p(),g("span",De,"?"+r(B(o)),1)):C("",!0)],64)):(p(),g("span",Re,r(o.raw),1)),o.body&&o.body!=="-"?(p(),M(ce,{key:2,placement:"bottom",title:"Request Body",trigger:"hover"},{content:i(()=>[s("div",{class:"popover-json",style:x({color:y.value?"#e2e8f0":"#333"})},r(o.body),5)]),default:i(()=>[v(E,{color:"orange",style:{"margin-left":"8px",cursor:"pointer","border-radius":"2px"},onClick:e[1]||(e[1]=Fe=>l.value=!0),title:"Click to Pause & Inspect"},{default:i(()=>[...e[9]||(e[9]=[f("BODY",-1)])]),_:1})]),_:2},1024)):C("",!0)]),s("div",Ue,[o.os?(p(),M(U,{key:0,title:o.ua},{default:i(()=>[v(E,{bordered:!1,class:"meta-tag"},{default:i(()=>[f(r(o.os),1)]),_:2},1024)]),_:2},1032,["title"])):C("",!0),o.device==="Mobile"?(p(),M(U,{key:1,title:"Mobile Device"},{default:i(()=>[...e[10]||(e[10]=[s("span",null,"ðŸ“±",-1)])]),_:1})):C("",!0)])]))),128))],4)],4)],544)])])}}},$e=he(Ve);$e.mount("#app");
